import{a8 as A,u as N,Q as P,r as j,w as q,a9 as W,t as o,e as f,f as a,v as l,j as x,x as h,k as r,P as g,h as u,F as B,i as O,L as b,H as V,aa as I,c as C,ab as Z,ac as X,o as Y,E as ee,ad as te,ae as ne}from"./index-CV6KFYyF.js";import{i as ae}from"./isAvailableForRank-BfkvvKaR.js";function oe(n){return n.replace(/^[\s_]+|[\s_]+$/g,"").replace(/[_\s]+/g," ").replace(/^[a-z]/,e=>e.toUpperCase())}function se(n,e){return n||(n={}),n._resolver=e,n}function re(n){return se(n,"taxon")}function le(n,e){return A({script:[{type:"application/ld+json",key:"schema-org-graph",nodes:n}]},{head:e})}function ue(){const n=N(),e=P(),s=j();q(e,()=>{s.value=d()},{immediate:!0});function d(){const{children:t}=n.getRoutes().find(m=>m.name==="otus-id");return t.map(({path:m,name:c,meta:_})=>({label:m&&(_.label||oe(m)),path:m,name:c,meta:_}))}return s}const L=Object.values([])[0];function ce({taxon:n,otu:e}){const s=P(),t={router:N(),route:s,taxon:n,otu:e};return{onCreatePage:()=>L?.onCreatePage(t),onSSRCreatePage:()=>L?.onSSRCreatePage(t)}}const ie={class:"p-4 pt-0"},de=["href"],me={__name:"DataMap",setup(n){const e=j(!1),s=W();return(d,t)=>{const m=o("IconJson"),c=o("VButton"),_=o("VTableHeaderCell"),w=o("VTableHeaderRow"),v=o("VTableHeader"),i=o("VTableBodyCell"),k=o("VTableBodyRow"),$=o("VTableBody"),T=o("VTable"),S=o("VModal");return a(),f("div",null,[l(c,{primary:"",class:"text-sm md:flex items-center gap-1 hidden",title:"Links used to obtain the information present on this page in JSON format.",onClick:t[0]||(t[0]=y=>e.value=!0)},{default:r(()=>[l(m,{class:"w-4 h-4"}),t[2]||(t[2]=g(" Datamap ",-1))]),_:1}),e.value?(a(),x(S,{key:0,onClose:t[1]||(t[1]=y=>e.value=!1)},{header:r(()=>[...t[3]||(t[3]=[u("h3",{class:"font-medium"},"Datamap",-1)])]),default:r(()=>[u("div",ie,[t[6]||(t[6]=u("p",{class:"text-sm mb-2"}," The following links provide the information present on this page in JSON format. ",-1)),l(T,null,{default:r(()=>[l(v,null,{default:r(()=>[l(w,null,{default:r(()=>[l(_,null,{default:r(()=>[...t[4]||(t[4]=[g(" Request Key ",-1)])]),_:1}),l(_,null,{default:r(()=>[...t[5]||(t[5]=[g(" URL ",-1)])]),_:1})]),_:1})]),_:1}),l($,null,{default:r(()=>[(a(!0),f(B,null,O(b(s).datamap,(y,R)=>(a(),x(k,{key:R},{default:r(()=>[l(i,{class:"capitalize"},{default:r(()=>[g(V(R.replaceAll(":"," ")),1)]),_:2},1024),l(i,null,{default:r(()=>[u("a",{href:y},V(y),9,de)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),_:1})):h("",!0)])}}},_e={class:"breadcrumb inline-flex items-center flex-wrap"},pe={class:"inline-flex items-center ml-0 text-sm"},fe=["innerHTML"],xe={__name:"Breadcrumb",props:{list:{type:Object,default:()=>({})},current:{type:Object,required:!0}},setup(n){return(e,s)=>{const d=o("IconArrowRight"),t=o("RouterLink");return a(),f("ul",_e,[(a(!0),f(B,null,O(n.list,([m],c,_)=>(a(),f("li",{key:m.id,class:"inline-flex items-center"},[_?(a(),x(d,{key:0,class:"w-3 h-3 mr-0.5 ml-0.5 opacity-50"})):h("",!0),l(t,{class:"inline-flex items-center text-sm text-accent-100 hover:text-gray-900 dark:hover:text-gray-500 text-secondary-color",to:{name:"otus-id",params:{id:m.id}}},{default:r(()=>[g(V(c),1)]),_:2},1032,["to"])]))),128)),u("li",pe,[l(d,{class:"w-3 h-3 mr-0.5 ml-0.5 opacity-50"}),u("span",{innerHTML:n.current.full_name_tag},null,8,fe)])])}}},ve={__name:"CommonNames",setup(n){const e=I(),s=C(()=>e.taxonomy.commonNames.map(d=>d.name).join("; "));return(d,t)=>(a(),f("span",null,V(s.value),1))}},be={class:"text-1xl capitalize"},he={class:"text-xl dark:text-gray-100"},ye=["title","innerHTML"],we={key:0,class:"ml-1 text-red-600",title:"Invalid"},ke={key:1,class:"text-base-soft text-base"},ge={class:"text-1xl"},Ve={__name:"TaxaInfo",setup(n){const e=I();return(s,d)=>(a(),f("div",null,[u("h2",be,V(b(e).taxon.rank||"Combination"),1),u("h1",he,[u("span",null,[u("span",{title:b(e).taxon.short_status,innerHTML:b(e).taxon.full_name_tag},null,8,ye),b(e).taxon.is_valid?h("",!0):(a(),f("span",we," âœ• ")),b(e).taxon.descorator_status.length?(a(),f("span",ke," ("+V(b(e).taxon.descorator_status.join("; "))+") ",1)):h("",!0)])]),u("h2",ge,[l(ve)])]))}};var Ce={url:"https://sfg.taxonworks.org/api/v1",project_token:"NwDdMde5__27Q7McrZm7Ng"};const Re={__name:"DWCDownload",props:{otu:{type:Object,required:!0}},setup(n){const{url:e,project_token:s}=Ce,d=n;function t(){window.open(`${e}/otus/${d.otu.id}/inventory/dwc.csv?project_token=${s}`,"_self")}return(m,c)=>{const _=o("IconDownload"),w=o("VButton");return a(),x(w,{primary:"",class:"text-sm flex items-center",title:"Download DwC Occurrences",onClick:c[0]||(c[0]=()=>{t()})},{default:r(()=>[l(_,{class:"w-4 h-4 mr-1"}),c[1]||(c[1]=g(" DwC ",-1))]),_:1})}}};var $e={project_name:"Ammonoidea"};const Te={class:"bg-base-foreground border-b border-base-muted pl-4 pr-4"},Se={class:"container mx-auto"},Ne={class:"pt-6 pb-6"},Pe={class:"flex flex-col-reverse md:flex-row justify-between items-start"},je={class:"mt-8 flex justify-between items-end"},Be={class:"flex flex-row gap-2"},Oe={class:"pt-3 pb-4"},Ie={class:"container mx-auto box-border"},He={__name:"Index",setup(n){const e=ne(),s=P(),d=N(),t=j(s.params),m=ue(),c=I(),_=Z();let w=new AbortController;d.afterEach(p=>{t.value=p.params});const v=C(()=>c.otu),i=C(()=>c.taxon),k=C(()=>v.value?.id&&i.value?.id),$=C(()=>m.value.filter(p=>ae(p.meta.rankGroup,i.value.rank_string))),{onCreatePage:T,onSSRCreatePage:S}=ce({taxon:i,otu:v});X(async()=>{await y(),await S()}),T(),q(()=>s.params.id,async()=>{w.abort(),w=new AbortController,y()}),Y(async()=>{v.value?.id!==Number(s.params.id)||!i.value?.id?await y():M()}),ee(()=>{c.$reset(),_.$reset()});async function y(){c.$reset(),_.$reset();try{await c.loadInit({otuId:s.params.id,controller:w}),M()}catch(p){p.name!==te.CanceledError&&R(p)}}function R(p){switch(p?.response?.status){case 404:d.replace({name:"httpError404"});break;case 500:d.replace({name:"httpError500"});break}}function M(){A({title:`${$e.project_name} - ${i.value.full_name}`},{head:e}),le([re({id:s.fullPath,name:i.value.full_name,scientificName:{name:i.value.full_name,author:i.value.author,taxonRank:i.value.rank},parentTaxon:{name:i.value.parent.full_name,taxonRank:i.value.parent.rank},commonNames:c.taxonomy.commonNames,alternateName:c.taxonomy.synonyms})],e)}function z({id:p,otu_valid_id:D}){d.push({name:"otus-id-overview",params:{id:D||p}})}return(p,D)=>{const H=o("VSkeleton"),F=o("Autocomplete"),J=o("ClientOnly"),U=o("TabItem"),Q=o("TabMenu"),G=o("RouterView");return a(),f("main",null,[u("div",Te,[u("div",Se,[u("div",Ne,[u("div",Pe,[l(H,{class:"w-full md:w-3/4"},{default:r(()=>[k.value?(a(),x(xe,{key:0,class:"w-full md:w-3/4",list:v.value?.parents||{},current:i.value},null,8,["list","current"])):h("",!0)]),_:1}),l(F,{class:"print:hidden min-w-full mb-2 md:min-w-fit md:ml-2 md:mb-0 md:w-96",url:"/otus/autocomplete","query-param":"term",label:"label_html",placeholder:"Search name...",params:{having_taxon_name_only:!0},onSelect:z})]),u("div",je,[l(H,{lines:2,class:"w-96"},{default:r(()=>[k.value?(a(),x(Ve,{key:0})):h("",!0)]),_:1}),u("div",Be,[l(J,null,{default:r(()=>[l(me)]),_:1}),k.value?(a(),x(Re,{key:0,otu:v.value},null,8,["otu"])):h("",!0)])])]),k.value&&b(m).length>1?(a(),x(Q,{key:0,class:"print:hidden"},{default:r(()=>[(a(!0),f(B,null,O($.value,({name:E,label:K})=>(a(),x(U,{key:E,to:{name:E}},{default:r(()=>[g(V(K),1)]),_:2},1032,["to"]))),128))]),_:1})):h("",!0)])]),u("div",Oe,[u("div",Ie,[k.value?(a(),x(G,{key:b(s).fullPath,"taxon-id":i.value.id,taxon:i.value,"taxon-rank":i.value.rank_string,"otu-id":v.value.id,otu:v.value},null,8,["taxon-id","taxon","taxon-rank","otu-id","otu"])):h("",!0)])])])}}};export{He as default};
