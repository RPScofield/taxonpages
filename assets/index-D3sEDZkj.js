import{r as V,c as z,t as l,e as x,f as m,v as t,j as g,x as w,k as u,h as r,P as T,H as le,F as I,q as F,s as U,_ as ne,o as ae,I as j,n as oe,R as A,w as se,i as K,S as ue,z as Q,Q as re,u as de,U as ie,O as Y,L}from"./index-CV6KFYyF.js";function X(p){return{page:Number(p["pagination-page"]),per:Number(p["pagination-per-page"]),total:Number(p["pagination-total"])}}const pe={key:0,class:"p-5 font-normal"},me={class:"pb-2 text-sm"},ce=["href"],ve={class:"relative"},_e=["innerHTML"],fe={__name:"DropdownMenu",props:{request:{type:Object,default:()=>({})}},setup(p){const d=V(!1),a=z(()=>[{label:"JSON Data",action:()=>d.value=!0}]);return(v,n)=>{const c=l("IconHamburger"),_=l("Dropdown"),o=l("VClipboard"),s=l("VModal");return m(),x(I,null,[t(_,{items:a.value},{button:u(()=>[t(c,{class:"text-base-soft h-4"})]),_:1},8,["items"]),d.value?(m(),g(s,{key:0,onClose:n[0]||(n[0]=y=>d.value=!1)},{header:u(()=>[...n[1]||(n[1]=[r("h3",null,"JSON Data",-1)])]),default:u(()=>[p.request?(m(),x("div",pe,[r("h3",me,[n[2]||(n[2]=T(" URL: ",-1)),r("a",{href:p.request.url},le(p.request.url),9,ce)]),r("div",ve,[r("p",{class:"bg-base-background p-2 text-sm font-normal whitespace-pre-wrap",innerHTML:JSON.stringify(p.request.data,null,4)},null,8,_e),t(o,{class:"absolute right-2 top-2 opacity-75",text:JSON.stringify(p.request.data,null,2)},null,8,["text"])])])):w("",!0)]),_:1})):w("",!0)],64)}}},E={__name:"YearPicker",props:F({min:{type:Number,required:!0},max:{type:Number,required:!0}},{modelValue:{type:Number,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(p){const d=p,a=U(p,"modelValue");function v(n){const c=Number(n.target.value);c<d.min?a.value=d.min:c>d.max?a.value=d.max:a.value=c}return(n,c)=>{const _=l("InputText");return m(),x("div",null,[t(_,{class:"w-14 max-w-14 text-sm",value:a.value,onChange:v},null,8,["value"])])}}},ye={class:"year-slider-container text-base-content"},be={class:"slider-wrapper"},Ve={class:"slider-track bg-base-muted"},xe=["min","max"],ge=["min","max"],we={__name:"VSlider",props:F({min:{type:Number,required:!0},max:{type:Number,required:!0}},{start:{type:Number,required:!0},startModifiers:{},end:{type:Number,required:!0},endModifiers:{}}),emits:["update:start","update:end"],setup(p){const d=p,a=U(p,"start"),v=U(p,"end"),n=z(()=>{const _=(a.value-d.min)/(d.max-d.min)*100,o=(v.value-d.min)/(d.max-d.min)*100;return{left:`${Math.min(_,o)}%`,width:`${Math.abs(o-_)}%`}}),c=()=>{a.value>v.value&&([a.value,v.value]=[v.value,a.value])};return ae(()=>{c()}),(_,o)=>(m(),x("div",ye,[r("div",be,[r("div",Ve,[r("div",{class:"slider-range",style:oe(n.value)},null,4),j(r("input",{class:"slider-input slider-input-start",type:"range",min:d.min,max:d.max,"onUpdate:modelValue":o[0]||(o[0]=s=>a.value=s),onInput:c},null,40,xe),[[A,a.value,void 0,{number:!0}]]),j(r("input",{class:"slider-input slider-input-end",type:"range",min:d.min,max:d.max,"onUpdate:modelValue":o[1]||(o[1]=s=>v.value=s),onInput:c},null,40,ge),[[A,v.value,void 0,{number:!0}]])])])]))}},Te=ne(we,[["__scopeId","data-v-6011370a"]]),Ce={class:"text-sm"},qe=["innerHTML"],Me={class:"md:max-h-[64vh] min-h-28 px-4 overflow-y-auto pb-4"},ke={key:0,class:"text-xl text-center my-8 w-full"},Ne={key:1},He={__name:"OtuModal",props:{sourceId:{type:Number,required:!0},label:{type:String,required:!0}},setup(p){const d=p,a=V({page:1,total:0,per:50}),v=V(!1),n=V(!1),c=V([]);function _(o=1){v.value=!0,Q.get("/otus",{params:{page:o,per:50,"taxon_name_query[source_query][source_id][]":d.sourceId,paginate:!0}}).then(({data:s,headers:y})=>{c.value=s,a.value=X(y)}).catch(()=>{}).finally(()=>{v.value=!1})}return se(n,o=>{o&&_()}),(o,s)=>{const y=l("IconPlusCircle"),M=l("VSpinner"),k=l("ClientOnly"),N=l("VPagination"),S=l("VTableHeaderCell"),b=l("VTableHeaderRow"),e=l("VTableHeader"),C=l("RouterLink"),q=l("VTableBodyCell"),H=l("VTableBodyRow"),$=l("VTableBody"),B=l("VTable"),R=l("VModal");return m(),x(I,null,[t(y,{class:"size-6 text-secondary-color cursor-pointer",onClick:s[0]||(s[0]=()=>n.value=!0)}),(m(),g(ue,{to:"body"},[n.value?(m(),g(R,{key:0,onClose:s[5]||(s[5]=()=>n.value=!1)},{header:u(()=>[r("div",Ce,[s[6]||(s[6]=T("Bibliography - ",-1)),r("span",{innerHTML:p.label},null,8,qe)])]),default:u(()=>[r("div",Me,[t(k,null,{default:u(()=>[v.value?(m(),g(M,{key:0})):w("",!0)]),_:1}),!v.value&&!c.value.length?(m(),x("div",ke," No records found. ")):w("",!0),c.value.length?(m(),x("div",Ne,[a.value.total>a.value.per?(m(),g(N,{key:0,class:"py-4",modelValue:a.value.page,"onUpdate:modelValue":[s[1]||(s[1]=f=>a.value.page=f),s[2]||(s[2]=f=>{_(f)})],total:a.value.total,per:a.value.per},null,8,["modelValue","total","per"])):w("",!0),t(B,null,{default:u(()=>[t(e,null,{default:u(()=>[t(b,null,{default:u(()=>[t(S,null,{default:u(()=>[...s[7]||(s[7]=[T("OTU",-1)])]),_:1})]),_:1})]),_:1}),t($,null,{default:u(()=>[(m(!0),x(I,null,K(c.value,f=>(m(),g(H,{key:f.id},{default:u(()=>[t(q,null,{default:u(()=>[t(C,{to:{name:"otus-id",params:{id:f.id}},innerHTML:f.object_tag},null,8,["to","innerHTML"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),a.value.total>a.value.per?(m(),g(N,{key:1,class:"pt-4",modelValue:a.value.page,"onUpdate:modelValue":[s[3]||(s[3]=f=>a.value.page=f),s[4]||(s[4]=f=>{_(f)})],total:a.value.total,per:a.value.per},null,8,["modelValue","total","per"])):w("",!0)])):w("",!0)])]),_:1})):w("",!0)]))],64)}}},$e={class:"container mx-auto box-border"},Be={class:"flex flex-col md:flex-row justify-center items-center gap-4 md:gap-2 text-sm"},Re={class:"flex flex-col w-full"},Ie={class:"flex flex-col w-full md:w-96"},Se={class:"w-full md:w-auto"},Le={class:"flex flex-row gap-2"},Pe={class:"flex flex-row gap-2 md:self-end"},Ue={class:"flex flex-row justify-between items-center mb-4"},Oe={class:"flex flex-col md:flex-row gap-3 md:items-center"},De={class:"flex flex-col md:flex-row gap-3 md:items-center mt-4"},J=50,P=1650,je={__name:"index",setup(p){const d=new Date().getFullYear(),a=re(),v=de(),n=V({}),c=V([]),_=V(!1),o=V({page:1,total:0,per:J}),s=V();async function y(b=1){_.value=!0,Q.get("/sources",{params:{in_project:!0,page:b,per:o.value.per,...n.value}}).then(({data:e,headers:C,request:q})=>{o.value=X(C),c.value=e,s.value={data:e,url:q.responseURL},S()}).finally(()=>{_.value=!1})}function M(b={}){n.value={year_start:Number(b.year_start||1650),year_end:Number(b.year_end||2025),author:b.author,query_term:b.query_term}}function k(b={}){o.value={page:Number(b.page)||1,total:0,per:J}}function N(){M(),k(),y()}function S(){v.push({query:{...n.value,page:o.value.page}})}return ie(()=>{M(a.query),k(a.query),y(o.value.page)}),(b,e)=>{const C=l("VSpinner"),q=l("ClientOnly"),H=l("InputText"),$=l("VButton"),B=l("VCardContent"),R=l("VCard"),f=l("VPagination"),O=l("VPaginationInfo"),D=l("VTableHeaderCell"),G=l("VTableHeaderRow"),W=l("VTableHeader"),h=l("VTableBodyCell"),Z=l("VTableBodyRow"),ee=l("VTableBody"),te=l("VTable");return m(),x("div",$e,[e[20]||(e[20]=r("h1",{class:"text-4xl px-4 md:px-0 mt-4 mb-6 font-bold"},"Bibliography",-1)),t(q,null,{default:u(()=>[_.value?(m(),g(C,{key:0,"full-screen":""})):w("",!0)]),_:1}),t(R,{class:"mb-4"},{default:u(()=>[t(B,null,{default:u(()=>[r("div",Be,[r("div",Re,[e[14]||(e[14]=r("label",null,"In citation",-1)),t(H,{class:"w-full",type:"text",placeholder:'Search anywhere in the citation... for example: "Charles Darwin Archives"',modelValue:n.value.query_term,"onUpdate:modelValue":e[0]||(e[0]=i=>n.value.query_term=i),onKeypress:e[1]||(e[1]=Y(()=>y(),["enter"]))},null,8,["modelValue"])]),r("div",Ie,[e[15]||(e[15]=r("label",null,"Author(s)",-1)),t(H,{class:"w-full",type:"text",placeholder:"Type...",modelValue:n.value.author,"onUpdate:modelValue":e[2]||(e[2]=i=>n.value.author=i),onKeypress:e[3]||(e[3]=Y(()=>y(),["enter"]))},null,8,["modelValue"])]),r("div",Se,[e[16]||(e[16]=r("span",null,"Published between:",-1)),r("div",Le,[t(E,{modelValue:n.value.year_start,"onUpdate:modelValue":e[4]||(e[4]=i=>n.value.year_start=i),min:P,max:L(d)},null,8,["modelValue","max"]),t(Te,{class:"w-full md:w-64",min:P,max:L(d),start:n.value.year_start,"onUpdate:start":e[5]||(e[5]=i=>n.value.year_start=i),end:n.value.year_end,"onUpdate:end":e[6]||(e[6]=i=>n.value.year_end=i)},null,8,["max","start","end"]),t(E,{modelValue:n.value.year_end,"onUpdate:modelValue":e[7]||(e[7]=i=>n.value.year_end=i),min:P,max:L(d)},null,8,["modelValue","max"])])]),r("div",Pe,[t($,{class:"text-sm py-1.5 border border-primary-color",primary:"",onClick:e[8]||(e[8]=()=>y())},{default:u(()=>[...e[17]||(e[17]=[T("Search",-1)])]),_:1}),t($,{class:"text-sm py-1.5 border border-primary-color",primary:"",onClick:e[9]||(e[9]=()=>N())},{default:u(()=>[...e[18]||(e[18]=[T(" Reset ",-1)])]),_:1})])])]),_:1})]),_:1}),t(R,null,{default:u(()=>[t(B,null,{default:u(()=>[r("div",Ue,[r("div",Oe,[t(f,{modelValue:o.value.page,"onUpdate:modelValue":[e[10]||(e[10]=i=>o.value.page=i),e[11]||(e[11]=i=>{y(i)})],total:o.value.total,per:o.value.per},null,8,["modelValue","total","per"]),t(O,{pagination:o.value},null,8,["pagination"])]),t(fe,{request:s.value},null,8,["request"])]),t(te,null,{default:u(()=>[t(W,null,{default:u(()=>[t(G,null,{default:u(()=>[t(D,{class:"w-2"}),t(D,null,{default:u(()=>[...e[19]||(e[19]=[T(" Sources ",-1)])]),_:1})]),_:1})]),_:1}),t(ee,null,{default:u(()=>[(m(!0),x(I,null,K(c.value,i=>(m(),g(Z,{key:i.id},{default:u(()=>[t(h,{class:"pr-1",title:"Show OTUs"},{default:u(()=>[t(He,{"source-id":i.id,label:i.cached},null,8,["source-id","label"])]),_:2},1024),t(h,{class:"break-all",innerHTML:i.cached},null,8,["innerHTML"])]),_:2},1024))),128))]),_:1})]),_:1}),r("div",De,[t(f,{modelValue:o.value.page,"onUpdate:modelValue":[e[12]||(e[12]=i=>o.value.page=i),e[13]||(e[13]=i=>{y(i)})],total:o.value.total,per:o.value.per},null,8,["modelValue","total","per"]),t(O,{pagination:o.value},null,8,["pagination"])])]),_:1})]),_:1})])}}};export{je as default};
